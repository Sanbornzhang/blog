---
title: Mysql 索引优化总结
date: 2019/2/25
categories: Mysql
tags: 
  - Mysql 
  - 索引
---
# 索引
## 索引的类型
* 按照存储方式: 聚簇索引,非聚簇索引.
* 数据的唯一性: 唯一索引,非唯一索引.
* 列个数: 单列索引,多列索引...
* 索引类型: B-Tree,Hash,R-Tree,全文索引...
## 使用的正确方式
1. 能用索引就用.
2. 使用辨识度较高的作为索引
3. 建立索引的字段不应为 `null`
4. 如果字段更新较为频繁不应使用索引
5. 使用索引时需要把区分度高的方最前面.
6. 单条查询使用Hash索引最优.
7. 多使用覆盖索引[如果一个索引包含(或覆盖)所有需要查询的字段的值，称为‘覆盖索引’。即只需扫描索引而无须回表。] 
8. 避免建立过多的索引[单表索引在5个以内,索引字段不应超过5个]
9. 关联字段使用索引
10. 联合查询使用`order` 需要把`order` 放在子查询中,可以使用延迟关联. [避免 `EXPLAIN` 中出现 `filesort` `tempoaray`]
## 索引不能命中
1. 模糊查询不能命中  
   `SELECT * FROM user WHERE name LIKE %s%` `%s` 导致全表扫描
2. 隐式转换导致全表扫描(Mysql)
3. 复合索引最左原则
4. 负向查询不能使用索引,优化为`in`(条数过多之后效率很低(控制在1000个以内),可以用子查询+join解决)
## 延迟关联
延迟关联总是和覆盖索引成对出现 思想是 通过`覆盖索引`查询返回需要的主键,在根据这些主键关联原表所需要获取的行,可以减少Mysql扫描所需要丢弃的行数,一般是用来优化`排序`

如果有`order`语句最好是先在子查询中先进行排序